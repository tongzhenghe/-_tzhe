<?php/** * Created by PhpStorm. * User: Administrator * Date: 2019/4/5 * Time: 14:04 */namespace app\index\model;use think\Db;use think\Session;class User extends Common{    /**     * 获得登陆用户信息     * @return mixed     */    public static function activeUserInfoOrFail()    {        if(!is_dir('./tmp/')) mkdir ('./tmp/', 0700);        session_save_path('./tmp/');        $userInfo = Session::get('userInfo');        if(!$userInfo || $userInfo['state'] === 2)            echo '<script>window.location.href = "/sign/signin";</script>';        return $userInfo;    }    public static function hasActiveUser()    {        return  Session::has('userInfo') && Session::has('userId');    }    public  static  function  insert_log( $userInfo, $msg )    {        if (!is_array($userInfo)) return false;        $data = [            'compid' => $userInfo['compid']            ,'user_ip' => gip()            ,'user_id' => intval( $userInfo['id'] )            ,'user_name' => trim( $userInfo['user_name'] )            ,'user_tel' => $userInfo['tel']            ,'time' => time()            ,'execute_content' => $msg        ];         Db::name('log')->insert($data);        return true;    }}